<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HubPorn</title>

  <!-- Fuente del t√≠tulo -->
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&display=swap" rel="stylesheet">

  <!-- Firebase (compat) -->
  <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <style>
    :root{
      --bg:#0d0d0d;
      --panel:#141414;
      --card:#1b1b1b;
      --border:#2a2a2a;
      --txt:#ffffff;
      --accent:#ff4444;
    }
    *{margin:0; padding:0; box-sizing:border-box}
    body{background:var(--bg); color:var(--txt); font-family: "Segoe UI", Tahoma, sans-serif;}

    /* Header */
    header{
      position:sticky; top:0; z-index:100;
      display:flex; align-items:center; justify-content:center;
      padding:14px 20px;
      background:linear-gradient(90deg,#161616,#0f0f0f);
      border-bottom:1px solid var(--border);
      box-shadow:0 4px 14px rgba(0,0,0,.35);
      cursor:pointer;
    }
    .title{
      font-family:"Archivo Black", sans-serif;
      font-size:2rem; line-height:1;
      background:linear-gradient(90deg, var(--accent), #ffa045);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      letter-spacing:.5px;
      user-select:none;
      transition:transform .2s;
    }
    .title:hover{ transform:scale(1.05); }

    /* Layout de 3 columnas */
    .layout{
      display:grid;
      grid-template-columns: 200px 1fr 240px;
      gap:15px;
      max-width:1400px;
      margin:20px auto;
      padding:0 10px;
    }

    .ads-left, .previews-right{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:10px;
      padding:10px;
      min-height:400px;
    }

    /* Banner superior de secciones */
    .top-banner{
      font-family:"Archivo Black", sans-serif;
      font-size:1.4rem;
      text-align:center;
      background:linear-gradient(90deg, #ff4444, #ffa045);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom:14px;
    }

    /* Grid Netflix (carpetas o videos) */
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(160px, 1fr));
      gap:18px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:12px;
      overflow:hidden;
      cursor:pointer;
      transition:transform .22s ease, box-shadow .22s ease, border-color .22s ease;
    }
    .card:hover{
      transform:translateY(-6px) scale(1.04);
      border-color:#3a3a3a;
      box-shadow:0 12px 26px rgba(0,0,0,.45), 0 0 18px rgba(255,68,68,.25);
    }
    .thumb{ width:100%; height:100px; object-fit:cover; display:block; background:#000; }
    .card-title{ text-align:center; font-size:.9rem; padding:8px; }

    /* Previews derecha (vertical) */
    .preview-item{ margin-bottom:12px; cursor:pointer; }
    .preview-item video{ width:100%; height:110px; object-fit:cover; border-radius:8px; background:#000; }
    .preview-title{ font-size:.85rem; margin-top:6px; text-align:center; color:#ccc; }

    /* Reproductor centrado */
    .player-wrap{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:12px;
      padding:14px;
    }
    .player{
      width:100%;
      display:flex;
      justify-content:center;
    }
    .player video{
      width:78%;
      max-width:820px;
      height:auto;
      border-radius:12px;
      background:#000;
    }
    .meta{ text-align:center; color:#bbb; margin-top:8px; font-size:.9rem; }

    /* Responsive */
    @media(max-width: 900px){
      .layout{ grid-template-columns:1fr; }
      .ads-left, .previews-right{ display:none; }
      .player video{ width:100%; max-width:100%; }
    }
  </style>
</head>
<body>
  <!-- Header (click = Home) -->
  <header onclick="renderHome()">
    <h1 class="title">HubPorn</h1>
  </header>

  <div class="layout">
    <!-- Izquierda: tu banner ad -->
    <aside class="ads-left">
      <div class="top-banner">Publicidad</div>
      <!-- üëá Tu script de banner (limpio y funcional) -->
      <script type="text/javascript">
        atOptions = {
          'key' : 'de13ddc2442e4144561bcec2fa1af174',
          'format' : 'iframe',
          'height' : 60,
          'width' : 468,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//leaklitre.com/de13ddc2442e4144561bcec2fa1af174/invoke.js"></script>
    </aside>

    <!-- Centro: grilla -->
    <main>
      <h2 id="centerTitle" class="top-banner">üìÇ Todas las carpetas</h2>
      <div id="centerArea" class="grid"></div>
    </main>

    <!-- Derecha: previews -->
    <aside class="previews-right">
      <div id="rightTitle" class="top-banner">üé¨ Previews</div>
      <div id="previewList"></div>
    </aside>
  </div>

  <script>
  window.addEventListener('DOMContentLoaded', () => {
    /* ===== Firebase ===== */
    const firebaseConfig = {
      apiKey: "AIzaSyCvQcDPSF9u1mr2RNQClhMEQ1yDZiuLM-M",
      authDomain: "minitinder-f6314.firebaseapp.com",
      projectId: "minitinder-f6314",
      storageBucket: "minitinder-f6314.appspot.com",
      messagingSenderId: "659347167496",
      appId: "1:659347167496:web:a4e76f562ffba1c4bdf4bd"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    /* ===== DOM refs ===== */
    const centerTitle = document.getElementById('centerTitle');
    const centerArea  = document.getElementById('centerArea');
    const previewList = document.getElementById('previewList');
    const rightTitle  = document.getElementById('rightTitle');

    /* ===== Helpers ===== */
    function cardFolderHTML(folderName, previewUrl){
      return `
        <div class="card" onclick="showFolder('${folderName}')">
          ${previewUrl ? `<video class="thumb" src="${previewUrl}" muted playsinline preload="metadata"></video>` : `<div class="thumb"></div>`}
          <div class="card-title">${folderName}</div>
        </div>`;
    }
    function cardVideoHTML(folderName, videoUrl, idx){
      return `
        <div class="card" onclick="playVideo('${folderName}', ${idx})">
          <video class="thumb" src="${videoUrl}" muted playsinline preload="metadata"></video>
          <div class="card-title">Ver video</div>
        </div>`;
    }
    function previewItemHTML(folderName, videoUrl, idx){
      return `
        <div class="preview-item" onclick="playVideo('${folderName}', ${idx})">
          <video src="${videoUrl}" muted playsinline preload="metadata"></video>
          <div class="preview-title">${folderName}</div>
        </div>`;
    }

    /* ===== HOME: todas las carpetas ===== */
    async function renderHome(){
      centerTitle.textContent = "üìÇ Todas las carpetas";
      rightTitle.textContent  = "üé¨ Previews";

      const snap = await db.collection("folders").get();
      const docs = snap.docs;

      // Centro: tarjetas de carpetas (con preview del primer video si hay)
      if (!docs.length){
        centerArea.innerHTML = `<p style="opacity:.7">No hay carpetas</p>`;
      } else {
        centerArea.className = "grid";
        centerArea.innerHTML = docs.map(doc=>{
          const data = doc.data(); const v = (data.videos||[])[0];
          return cardFolderHTML(doc.id, v?.url);
        }).join("");
      }

      // Derecha: un preview por carpeta (si hay)
      previewList.innerHTML = docs.map(doc=>{
        const data = doc.data(); const v = (data.videos||[])[0];
        return v ? previewItemHTML(doc.id, v.url, 0) : "";
      }).join("");
    }

    /* ===== Carpeta: muestra videos de esa carpeta ===== */
    async function showFolder(folderName){
      centerTitle.textContent = `üìÅ ${folderName}`;
      rightTitle.textContent  = `üé¨ Previews de ${folderName}`;

      const ref = db.collection("folders").doc(folderName);
      const doc = await ref.get();
      if(!doc.exists){
        centerArea.innerHTML = `<p style="opacity:.7">Esta carpeta no existe</p>`;
        previewList.innerHTML = "";
        return;
      }
      const data = doc.data();
      const videos = data.videos || [];

      // Centro: tarjetas de videos de esa carpeta
      centerArea.className = "grid";
      if(!videos.length){
        centerArea.innerHTML = `<p style="opacity:.7">No hay videos en esta carpeta</p>`;
      }else{
        centerArea.innerHTML = videos.map((v, idx)=> cardVideoHTML(folderName, v.url, idx)).join("");
      }

      // Derecha: lista vertical (toda la carpeta)
      previewList.innerHTML = videos.map((v, idx)=> previewItemHTML(folderName, v.url, idx)).join("");
    }

    /* ===== Player: reproduce video al centro y mantiene previews a la derecha ===== */
    async function playVideo(folderName, idx){
      const ref = db.collection("folders").doc(folderName);
      const doc = await ref.get();
      if(!doc.exists) return;

      const data = doc.data();
      const videos = data.videos || [];
      const v = videos[idx]; if(!v) return;

      centerTitle.textContent = `‚ñ∂ Reproduciendo`;
      // Player centrado
      centerArea.className = "";
      centerArea.innerHTML = `
        <div class="player-wrap">
          <div class="player">
            <video id="videoPlayer" controls controlsList="nodownload noplaybackrate" oncontextmenu="return false;" autoplay playsinline>
              <source src="${v.url}" type="video/mp4">
            </video>
          </div>
          <div class="meta">Carpeta: ${folderName} ‚Ä¢ Video ${idx+1}</div>
        </div>
      `;

      // Derecha: aseguramos que se vea la carpeta actual
      rightTitle.textContent = `üé¨ Previews de ${folderName}`;
      previewList.innerHTML = videos.map((item, i)=> previewItemHTML(folderName, item.url, i)).join("");
    }

    /* Exponer funciones para los onclick */
    window.renderHome = renderHome;
    window.showFolder = showFolder;
    window.playVideo  = playVideo;

    /* Primera carga -> Home */
    renderHome();
  });
  </script>
</body>
</html>
