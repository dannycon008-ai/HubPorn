<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HubPorn</title>

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Poppins:wght@500;700&display=swap" rel="stylesheet">

  <!-- Firebase -->
  <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <style>
    :root {
      --bg:#0d0d0d; --panel:#141414; --card:#1b1b1b;
      --border:#2a2a2a; --txt:#ffffff; --accent:#ff4444;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{background:var(--bg);color:var(--txt);font-family:'Poppins',sans-serif;}

    header{position:sticky;top:0;z-index:100;display:flex;justify-content:center;align-items:center;
      padding:14px 20px;background:linear-gradient(90deg,#161616,#0f0f0f);border-bottom:1px solid var(--border);cursor:pointer}
    .title{font-family:"Archivo Black",sans-serif;font-size:2rem;background:linear-gradient(90deg,var(--accent),#ffa045);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent}

    .layout{display:grid;grid-template-columns:200px 1fr 220px;gap:15px;max-width:1400px;margin:20px auto;padding:0 10px}
    .ads-left,.previews-right{background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:10px}
    .top-banner{font-family:"Archivo Black",sans-serif;font-size:1.2rem;text-align:center;background:linear-gradient(90deg,#ff4444,#ffa045);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:14px}
    .card{background:var(--card);border-radius:12px;overflow:hidden;cursor:pointer;transition:transform .25s,box-shadow .25s;
      box-shadow:0 3px 10px rgba(0,0,0,.3)}
    .card:hover{transform:scale(1.04);box-shadow:0 6px 18px rgba(0,0,0,.4)}
    .card-thumb{width:100%;height:110px;object-fit:cover;background:#000;display:block}
    .card-title{font-size:.85rem;font-weight:600;text-align:center;padding:6px}

    .video-container{display:flex;gap:15px;justify-content:center;align-items:flex-start}
    .video-player{flex:2;text-align:center;position:relative}
    .video-player video{width:100%;max-width:480px;border-radius:10px;background:#000}
    #adContainer{margin-top:12px;text-align:center}
    .countdown{color:var(--accent);font-weight:bold;margin:10px 0}

    .spinner{border:4px solid #444;border-top:4px solid var(--accent);border-radius:50%;width:40px;height:40px;
      animation:spin 1s linear infinite;margin:20px auto}
    .video-spinner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}

    .most-viewed{flex:1;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:10px;max-height:480px;overflow-y:auto}
    .most-viewed h3{font-size:1rem;margin-bottom:8px;text-align:center;color:var(--accent)}
    .mv-item{margin-bottom:8px;cursor:pointer;position:relative}
    .mv-item video{width:100%;height:70px;object-fit:cover;border-radius:6px}
    .mv-title{font-size:.75rem;margin-top:2px;text-align:center;color:#bbb}

    .ads-left img,.ads-mobile img{max-width:100%;border-radius:8px;display:block}
    .ads-mobile{display:none;text-align:center;margin:10px 0}

    /* ‚úÖ Nueva secci√≥n de m√°s vistos solo en m√≥vil */
    .mobile-most-viewed{display:none;background:var(--panel);padding:10px;border:1px solid var(--border);border-radius:10px;margin-top:10px}
    .mobile-most-viewed h3{text-align:center;font-size:1rem;margin-bottom:6px;color:var(--accent)}
    .mobile-most-viewed .mv-item{display:inline-block;width:30%;margin:4px}
    .mobile-most-viewed .mv-item video{width:100%;height:60px;object-fit:cover;border-radius:6px}

    @media(max-width:900px){
      .layout{grid-template-columns:1fr}
      .ads-left,.previews-right{display:none}
      .ads-mobile{display:block}
      .video-container{flex-direction:column}
      .most-viewed{width:100%;max-height:none;margin-top:12px}
      .mv-item video{height:60px}
      .mobile-most-viewed{display:block}
    }
  </style>
</head>
<body>
  <header onclick="goHome()"><h1 class="title">HubPorn</h1></header>

  <div class="ads-mobile">
    <a href="https://overplantovervaluetwine.com/2061965" target="_blank">
      <img src="https://s11.erome.com/2497/nZMW9sgy/GEJPGxVJ.jpeg" alt="Publicidad">
    </a>
  </div>

  <div class="layout">
    <aside class="ads-left">
      <div class="top-banner">üëáChat en vivoüëá</div>
      <a href="https://overplantovervaluetwine.com/2061965" target="_blank">
        <img src="https://s11.erome.com/2497/nZMW9sgy/BxCKl0pg.jpeg" alt="Publicidad">
      </a>
    </aside>

    <main>
      <h2 class="top-banner" id="sectionTitle">VIDEOS PORNO GRATIS</h2>
      <div id="folderGrid" class="grid"></div>
      <div id="videoSection"></div>
    </main>

    <aside class="previews-right">
      <div class="top-banner">Videos mas vistos</div>
      <div id="previewList"></div>
    </aside>
  </div>

  <script>
  window.addEventListener('DOMContentLoaded', () => {
    const firebaseConfig = {
      apiKey:"AIzaSyCvQcDPSF9u1mr2RNQClhMEQ1yDZiuLM-M",
      authDomain:"minitinder-f6314.firebaseapp.com",
      projectId:"minitinder-f6314",
      storageBucket:"minitinder-f6314.appspot.com",
      messagingSenderId:"659347167496",
      appId:"1:659347167496:web:a4e76f562ffba1c4bdf4bd"
    };
    if(!firebase.apps.length)firebase.initializeApp(firebaseConfig);
    const db=firebase.firestore();

    const folderGrid=document.getElementById("folderGrid");
    const previewList=document.getElementById("previewList");
    const videoSection=document.getElementById("videoSection");
    const sectionTitle=document.getElementById("sectionTitle");

    function renderHome(docs){
      sectionTitle.textContent="VIDEOS PORNO GRATIS";
      videoSection.innerHTML="";
      folderGrid.style.display="grid";
      if(!docs.length){folderGrid.innerHTML="<p>No hay carpetas</p>";return;}
      folderGrid.innerHTML=docs.map(doc=>{
        const folder=doc.id,data=doc.data(),videos=data.videos||[];
        const preview=videos[0]?.poster||videos[0]?.url||"";
        return `
          <div class="card" onclick="openFolder('${folder}')">
            <div class="spinner" id="spin-${folder}" style="width:24px;height:24px;margin:10px auto;"></div>
            ${preview?`<video class="card-thumb" src="${preview}#t=2" muted preload="metadata" playsinline 
              oncanplay="document.getElementById('spin-${folder}').style.display='none'"></video>`:`<div style="height:100px;background:#222"></div>`}
            <div class="card-title">${folder}</div>
          </div>`;
      }).join("");
    }

    async function openFolder(folder){
      const snap=await db.collection("folders").doc(folder).get();
      if(!snap.exists){sectionTitle.textContent=folder;folderGrid.innerHTML="";videoSection.innerHTML="<p>No hay videos</p>";return;}
      sectionTitle.textContent=folder;folderGrid.style.display="none";
      const data=snap.data();
      videoSection.innerHTML=`
        <div class="grid">
          ${data.videos.map((v,idx)=>`
            <div class="card" onclick="playVideo('${folder}',${idx})">
              <div class="spinner" id="spin-${folder}-${idx}" style="width:20px;height:20px;margin:6px auto;"></div>
              <video class="card-thumb" src="${v.poster||v.url}#t=2" muted preload="metadata" playsinline
                oncanplay="document.getElementById('spin-${folder}-${idx}').style.display='none'"></video>
              <div class="card-title">Video ${idx+1}</div>
            </div>`).join("")}
        </div>`;
      history.pushState({page:"folder",folder},"","#"+folder);
    }

    async function playVideo(folder,idx){
      const ref=db.collection("folders").doc(folder);
      const snap=await ref.get();if(!snap.exists)return;
      const data=snap.data(),v=data.videos[idx];
      v.views=(v.views||0)+1;data.videos[idx]=v;await ref.update({videos:data.videos});
      sectionTitle.textContent=`‚ñ∂ ${folder}`;folderGrid.style.display="none";

      videoSection.innerHTML=`
        <div class="video-container">
          <div class="video-player">
            <div class="spinner video-spinner" id="loadingSpinner"></div>
            <video id="videoPlayer" controls autoplay poster="${v.poster||v.url}" controlsList="nodownload">
              <source src="${v.url}" type="video/mp4">
            </video>
            <p>üëÅÔ∏è ${v.views} vistas</p>
            <div id="adContainer"></div>
            <div id="bannerAd"></div>
          </div>
        </div>
        <div class="mobile-most-viewed" id="mobileMostViewed"></div>`; <!-- ‚úÖ secci√≥n m√°s vistos -->

      const player=document.getElementById("videoPlayer");
      const spinner=document.getElementById("loadingSpinner");
      player.addEventListener("canplay",()=>{spinner.style.display="none";});

      const banner=document.getElementById("bannerAd");
      banner.innerHTML="";
      const s1=document.createElement("script");
      s1.innerHTML=`atOptions={key:'de13ddc2442e4144561bcec2fa1af174',format:'iframe',height:60,width:468,params:{}};`;
      const s2=document.createElement("script");
      s2.src="//leaklitre.com/de13ddc2442e4144561bcec2fa1af174/invoke.js";
      banner.appendChild(s1);banner.appendChild(s2);

      let ads={start:false,mid:false};
      player.addEventListener("play",()=>{if(!ads.start){ads.start=true;showAd(player);}});
      player.addEventListener("timeupdate",()=>{if(player.currentTime>=50&&!ads.mid){ads.mid=true;showAd(player);}});

      // ‚úÖ cargar los m√°s vistos en m√≥vil
      loadMostViewedMobile();
      history.pushState({page:"video",folder,idx},"","#video");
    }

    function showAd(player){
      const current=player.currentTime;
      player.pause();
      const adBox=document.getElementById("adContainer");
      adBox.innerHTML=`<div class="countdown">Publicidad... regresando en <span id="cd">5</span>s</div>`;
      window.open("https://overplantovervaluetwine.com/2061965","_blank");
      let c=5;const timer=setInterval(()=>{
        c--;document.getElementById("cd").textContent=c;
        if(c===0){clearInterval(timer);adBox.innerHTML="";player.currentTime=current;player.play();}
      },1000);
    }

    function renderPreviews(docs){
      let previews=[];
      docs.forEach(doc=>{
        const data=doc.data(),videos=data.videos||[];
        if(videos.length>0){
          const r=Math.floor(Math.random()*videos.length);
          previews.push({folder:doc.id,url:videos[r].url});
        }
      });
      previewList.innerHTML=previews.map(p=>`
        <div class="preview-item mv-item" onclick="playVideo('${p.folder}',0)">
          <div class="spinner" style="width:20px;height:20px;" id="spin-${p.folder}"></div>
          <video src="${p.url}#t=2" muted preload="none" playsinline oncanplay="document.getElementById('spin-${p.folder}').style.display='none'"></video>
          <div class="preview-title">${p.folder}</div>
        </div>`).join("");
    }

    // ‚úÖ render de los m√°s vistos m√≥viles
    async function loadMostViewedMobile(){
      const container=document.getElementById("mobileMostViewed");
      if(!container) return;
      const snapshot=await db.collection("folders").get();
      let allVideos=[];
      snapshot.forEach(doc=>{
        (doc.data().videos||[]).forEach(v=>{
          allVideos.push({folder:doc.id,...v});
        });
      });
      allVideos.sort((a,b)=> (b.views||0)-(a.views||0));
      const top=allVideos.slice(0,6);
      container.innerHTML="<h3>üî• M√°s vistos</h3>"+top.map((v,i)=>`
        <div class="mv-item" onclick="playVideo('${v.folder}',${i})">
          <video src="${v.url}#t=2" muted playsinline></video>
        </div>`).join("");
    }

    function goHome(){
      db.collection("folders").get().then(s=>renderHome(s.docs));
      history.pushState({ page:"home" },"","#home");
    }

    // üîô Manejo de bot√≥n atr√°s
    window.onpopstate=function(event){
      if(!event.state){ goHome(); return; }
      if(event.state.page==="home"){ goHome(); }
      else if(event.state.page==="folder"){ openFolder(event.state.folder); }
      else if(event.state.page==="video"){ playVideo(event.state.folder,event.state.idx); }
    };

    window.openFolder=openFolder;
    window.playVideo=playVideo;
    window.goHome=goHome;

    db.collection("folders").get().then(s=>{
      renderHome(s.docs);
      renderPreviews(s.docs);
      history.replaceState({page:"home"},"","#home");
    });
  });
  </script>
</body>
</html>
